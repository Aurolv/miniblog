<% content_for :title, "Posts" %>

<div class="posts-directory">
  <header class="posts-directory-hero <%= 'posts-directory-hero--drafts' if @listing_scope == :drafts %>">
    <div>
      <% if @listing_scope == :drafts %>
        <p class="posts-directory-kicker">Draft area</p>
        <h1 class="posts-directory-title">Only visible to you</h1>
        <p class="posts-directory-subtitle">Finish, polish, and publish when you're ready.</p>
      <% else %>
        <p class="posts-directory-kicker">Latest stories</p>
        <h1 class="posts-directory-title">Browse inspiring writing</h1>
        <p class="posts-directory-subtitle">
          Fresh ideas from authors you follow and the wider community. Dive in or publish your own.
        </p>
      <% end %>
    </div>
    <% if logged_in? %>
      <%= link_to (@listing_scope == :drafts ? "Back to posts" : "New post"),
            (@listing_scope == :drafts ? posts_path : new_post_path), class: "btn-primary" %>
    <% end %>
  </header>

  <% if @listing_scope != :drafts %>
    <div class="posts-directory-filters">
      <span>Sort by</span>
      <div class="posts-sort-options">
        <% [ ["Latest", "latest"], ["Popular", "popular"], ["Discussed", "discussed"] ].each do |label, value| %>
          <% active = @sort == value %>
          <%= link_to label,
                posts_path(sort: value),
                class: "posts-sort-chip #{'posts-sort-chip--active' if active}" %>
        <% end %>
      </div>
    </div>
  <% else %>
    <div class="drafts-tip">
      <p class="text-sm text-slate-600">Drafts can't be liked or commented on. Use edit to keep writing, or publish when you're ready.</p>
    </div>
  <% end %>

  <% if @posts.any? %>
    <div class="posts-grid">
      <%= render @posts %>
    </div>
  <% else %>
    <div class="posts-empty">
      <div class="posts-empty-icon">ğŸ“</div>
      <h3>No posts yet</h3>
      <p>
        <% if @listing_scope == :drafts %>
          Start writing and save drafts here. Publish when you're ready.
        <% else %>
          Be the first to share something inspiring with the community.
        <% end %>
      </p>
      <% if logged_in? %>
        <%= link_to (@listing_scope == :drafts ? "Create draft" : "Write a post"), new_post_path, class: "btn-primary" %>
      <% else %>
        <%= link_to "Log in to post", login_path, class: "btn-primary" %>
      <% end %>
    </div>
  <% end %>
</div>
